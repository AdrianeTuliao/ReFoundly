<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReFoundly - Report Item</title>
    <link rel="stylesheet" href="report.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <header class="navbar">
        <h1>ReFoundly</h1>
        <div class="nav-icons">
            <a href="history.html" class="history-link">
                <i class="fas fa-history"></i>
            </a>
            <a href="message.html" class="history-link active-link">
                <i class="fas fa-comment-dots"></i>
            </a>
            <i class="fas fa-bell"></i>
            <i class="fas fa-user-circle"></i>
        </div>
    </header>

    <main class="container">
        <nav class="breadcrumb">
            <a href="dashboard.html">Home</a> &gt; <span>Report Lost/Found Items</span>
        </nav>

        <section class="form-card">
            <form action="/submit-report" method="POST" enctype="multipart/form-data">
                
                <div class="form-row">
            <div class="form-column">
                <div class="input-group">
                    <label>What was Lost<span>*</span></label>
                    <small>(Wallet, Smartphone, T-shirt, etc.)</small>
                    <input type="text" name="itemName" placeholder="Enter item name" required>
                </div>

                <div class="input-group">
                    <label>Category<span>*</span></label>
                    <small>(Wallet, Gadgets, Clothing, etc.)</small>
                    <select name="category" required>
                        <option value="" disabled selected>Select Category...</option>
                        <option value="wallet">Wallet</option>
                        <option value="cellphone">Cellphone</option>
                        </select>
                </div>

                <div class="input-group">
                    <label>Brand<span>*</span></label>
                    <small>(Gucci, Samsung, Lacoste, etc.)</small>
                    <input type="text" name="brand" placeholder="Optional">
                </div>

                <div class="input-group">
                    <label>Date Lost<span>*</span></label>
                    <small>Approximate date of when the item was lost.</small>
                    <input type="date" name="dateLost" required>
                </div>

                <div class="input-group">
                    <label>Time Lost<span>*</span></label>
                    <small>Approximate time of day the item was lost.</small>
                    <input type="time" name="timeLost" required>
                </div>
            </div>

            <div class="form-column">
                <div class="input-group">
                    <label>Upload Image</label>
                    <small>(This image will display on the Website.)</small>
                    <div class="image-upload-box" onclick="document.getElementById('file-upload').click()">
                        <i class="fas fa-image" style="font-size: 3rem; margin-bottom: 10px;"></i>
                        <p>Insert Image</p>
                        <input type="file" name="itemImage" id="file-upload" hidden>
                    </div>
                </div>

                <div class="input-group">
                    <label>Additional Information</label>
                    <small>Details or description of your lost items.</small>
                    <textarea name="description" rows="6" style="resize: vertical;"></textarea>
                </div>
            </div>
        </div>

        <div class="form-row">
            <div class="form-column">
                <h3>Location Information</h3>
                <div class="input-group">
                    <label>Where Lost<span>*</span></label>
                    <small>City, Barangay, or specific landmark.</small>
                    <input type="text" name="location" required>
                </div>
            </div>

            <div class="form-column">
                <h3>What are you reporting?</h3>
                <div class="report-selection">
                    <div class="checkbox-group">
                        <input type="radio" name="reportType" value="Lost" id="lost" required>
                        <label for="lost"><strong>I Lost an Item</strong><br><small>I am trying to find something I lost.</small></label>
                    </div>
                    <div class="checkbox-group">
                        <input type="radio" name="reportType" value="Found" id="found">
                        <label for="found"><strong>I Found an Item</strong><br><small>I want to report an item I found.</small></label>
                    </div>
                </div>
            </div>
        </div>

        <hr class="separator">

        <h3>Contact Information</h3>
        <div class="form-row">
            <div class="form-column">
                <div class="input-group">
                    <label>First Name<span>*</span></label>
                    <input type="text" name="firstName" required>
                </div>
                <div class="input-group">
                    <label>Phone Number<span>*</span></label>
                    <input type="tel" name="phoneNumber" required>
                </div>
            </div>
            <div class="form-column">
                <div class="input-group">
                    <label>Last Name<span>*</span></label>
                    <input type="text" name="lastName" required>
                </div>
                <div class="input-group">
                    <label>Email<span>*</span></label>
                    <input type="email" name="email" required>
                </div>
            </div>
        </div>
        
        <div class="submit-section">
            <button type="submit" class="btn-main">Submit Report</button>
        </div>
            </form>
        </section>
    </main>

    <footer>
        <div class="footer-links">
            <a href="#">About</a> | <a href="#">Contact</a> | <a href="#">Privacy Policy</a> | <a href="#">Terms</a>
        </div>
        <div class="socials">
            <i class="fab fa-facebook"></i>
            <i class="fab fa-instagram"></i>
            <i class="fab fa-linkedin"></i>
        </div>
        <p>Â© 2026 Digital Lost & Found Portal</p>
    </footer>

    <script>
    // 1. Make the "Insert Image" box show a preview
    const fileInput = document.getElementById('file-upload');
    const uploadBox = document.querySelector('.image-upload-box');

    fileInput.addEventListener('change', function() {
        if (this.files && this.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                uploadBox.style.backgroundImage = `url('${e.target.result}')`;
                uploadBox.style.backgroundSize = 'cover';
                uploadBox.style.backgroundPosition = 'center';
                // Hide the icon and text so the image is visible
                uploadBox.querySelector('i').style.display = 'none';
                uploadBox.querySelector('p').style.display = 'none';
            }
            reader.readAsDataURL(this.files[0]);
        }
    });

    // 2. Auto-fill Contact Info from the logged-in user
    window.onload = async () => {
        try {
            const response = await fetch('/user/me');
            if (response.ok) {
                const user = await response.json();
                // Splitting full_name for First/Last name inputs
                const names = user.full_name.split(' ');
                document.getElementsByName('firstName')[0].value = names[0] || '';
                document.getElementsByName('lastName')[0].value = names.slice(1).join(' ') || '';
                document.getElementsByName('email')[0].value = user.email || '';
                document.getElementsByName('phoneNumber')[0].value = user.contact_number || '';
            }
        } catch (error) {
            console.log("Not logged in or server error");
        }
    };
</script>

</body>
</html>